# ğŸš€ SUPCHAT - Guide de Configuration et DÃ©marrage

## ğŸ“‹ Description du Projet

SupChat est une application de messagerie collaborative composÃ©e de :
- **Backend API** (Node.js + MongoDB) dans `supchat-server/`
- **Frontend Web** (React + TypeScript + Vite) dans `client-web/`
- **Application Mobile** (React Native + Expo) dans `client-mobile/`

## ğŸ› ï¸ MÃ©thodes de DÃ©marrage

### MÃ©thode 1: Docker Compose (RecommandÃ©e pour le livrable)
### MÃ©thode 2: DÃ©veloppement Local (Pour le dÃ©veloppement)

---

## ğŸ³ MÃ‰THODE 1: DOCKER COMPOSE (PRODUCTION)

### PrÃ©requis
- Docker et Docker Compose installÃ©s
- Ports 80, 3000, 27017 disponibles

### Ã‰tapes de dÃ©marrage

1. **Cloner le projet et aller Ã  la racine**
```bash
cd supchat-1/
```

2. **VÃ©rifier la configuration .env**
Le fichier `.env` Ã  la racine contient toute la configuration nÃ©cessaire.
Les variables importantes pour Docker :
- `NODE_ENV=production`
- `MONGO_HOST=db` (utilise le service Docker)
- Tous les secrets OAuth et JWT configurÃ©s

3. **Lancer tous les services**
```bash
# Lancer tous les services (API + Web + Mobile + DB)
docker-compose up -d

# Ou lancer service par service
docker-compose up db          # Base de donnÃ©es MongoDB
docker-compose up api         # API Backend 
docker-compose up web         # Client Web
docker-compose up mobile      # Client Mobile
```

4. **AccÃ©der aux applications**
- **Web App**: http://localhost (port 80)
- **API**: http://localhost:3000
- **MongoDB**: localhost:27017 (accÃ¨s local seulement)
- **Monitoring**: http://localhost:8005 (cAdvisor)

5. **ArrÃªter les services**
```bash
docker-compose down
```

### Variables d'environnement Docker

Dans Docker, les services communiquent via les noms de services :
- `api` â†’ Service backend
- `db` â†’ Service MongoDB
- `web` â†’ Service frontend
- `mobile` â†’ Service mobile

---

## ğŸ’» MÃ‰THODE 2: DÃ‰VELOPPEMENT LOCAL

### PrÃ©requis
- Node.js >= 18
- MongoDB installÃ© localement OU Docker pour la DB
- npm ou yarn

### ğŸ—„ï¸ Ã‰tape 1: Base de donnÃ©es

**Option A: MongoDB avec Docker (RecommandÃ©)**
```bash
docker-compose up db
```

**Option B: MongoDB local**
```bash
# Installer MongoDB localement et dÃ©marrer le service
mongod --dbpath /path/to/your/db
```

### ğŸ”§ Ã‰tape 2: Configuration Backend

```bash
cd supchat-server/
cp .env.example .env  # Si pas dÃ©jÃ  fait
```

VÃ©rifier le fichier `supchat-server/.env` :
```bash
NODE_ENV=development
MONGO_HOST=localhost  # Pour dÃ©veloppement local
PORT=3000
# ... autres variables dÃ©jÃ  configurÃ©es
```

Installer et dÃ©marrer :
```bash
npm install
npm start
```

### ğŸŒ Ã‰tape 3: Client Web

```bash
cd client-web/
cp .env.example .env  # Si pas dÃ©jÃ  fait
```

VÃ©rifier le fichier `client-web/.env` :
```bash
VITE_API_URL=http://localhost:3000
VITE_WEBSOCKET_URL=http://localhost:3000
# ... autres variables dÃ©jÃ  configurÃ©es
```

Installer et dÃ©marrer :
```bash
npm install
npm run dev  # DÃ©marre sur http://localhost:5173
```

### ğŸ“± Ã‰tape 4: Client Mobile

```bash
cd client-mobile/
```

**IMPORTANT**: Modifier `client-mobile/.env` avec votre IP locale :
```bash
# Trouver votre IP locale
ipconfig        # Windows
ifconfig        # Mac/Linux

# Modifier dans client-mobile/.env
EXPO_PUBLIC_HOST=192.168.1.XXX  # Votre IP
EXPO_PUBLIC_API_URL=http://192.168.1.XXX:3000/api
```

Installer et dÃ©marrer :
```bash
npm install
npm start  # Ou expo start
```

---

## ğŸ” CONFIGURATION OAUTH (DÃ©jÃ  configurÃ©e)

### Google OAuth
- Client ID: `991869916796-re5ejvbv6d4h825kfog0u2k870tqda1c.apps.googleusercontent.com`
- Redirect URI: `http://localhost:3000/api/auth/google/callback`

### Facebook OAuth  
- App ID: `766701949015755`
- Redirect URI: `http://localhost:3000/api/auth/facebook/callback`

âš ï¸ **Note**: Les secrets OAuth sont configurÃ©s cÃ´tÃ© serveur uniquement pour la sÃ©curitÃ©.

---

## ğŸ§ª TESTS

### Tests Backend
```bash
cd supchat-server/
npm test
```

### Tests Frontend Web
```bash
cd client-web/
npm test              # Tests unitaires
npm run test:coverage # Couverture de code
```

---

## ğŸ“‚ STRUCTURE DES VARIABLES D'ENVIRONNEMENT

### Fichier `.env` (Racine - Docker)
```
NODE_ENV=production
PORT=3000
MONGO_HOST=db  # Service Docker
JWT_SECRET=...
GOOGLE_CLIENT_SECRET=...
# Variables pour tous les services en Docker
```

### Fichier `supchat-server/.env` (DÃ©veloppement)
```
NODE_ENV=development  
MONGO_HOST=localhost  # DÃ©veloppement local
# Variables spÃ©cifiques au backend
```

### Fichier `client-web/.env` (DÃ©veloppement)
```
VITE_API_URL=http://localhost:3000
# Variables cÃ´tÃ© client web (prÃ©fixe VITE_)
```

### Fichier `client-mobile/.env` (DÃ©veloppement)
```
EXPO_PUBLIC_API_URL=http://192.168.X.X:3000/api
# Variables cÃ´tÃ© mobile (prÃ©fixe EXPO_PUBLIC_)
```

---

## ğŸš¨ DÃ‰PANNAGE

### ProblÃ¨me: Cannot connect to API
- VÃ©rifier que l'API tourne sur le bon port
- En Docker: utiliser le nom du service `api` au lieu de `localhost`
- En local: vÃ©rifier `localhost:3000`

### ProblÃ¨me: Mobile ne se connecte pas
- VÃ©rifier l'IP dans `client-mobile/.env`
- S'assurer que PC et tÃ©lÃ©phone sont sur le mÃªme rÃ©seau WiFi
- VÃ©rifier le firewall Windows/Mac

### ProblÃ¨me: Base de donnÃ©es
- En Docker: `docker-compose logs db`
- En local: vÃ©rifier que MongoDB tourne

### ProblÃ¨me: Ports dÃ©jÃ  utilisÃ©s
```bash
# Voir qui utilise le port 3000
netstat -ano | findstr :3000  # Windows
lsof -i :3000                 # Mac/Linux
```

---

## ğŸ“‹ CHECKLIST LIVRABLE

- âœ… Docker Compose fonctionne avec `docker-compose up`
- âœ… 3 services minimum : api, web, db
- âœ… Pas de secrets dans le code source
- âœ… Variables d'environnement configurÃ©es
- âœ… Documentation technique et utilisateur
- âœ… Architecture serveur-client respectÃ©e

---

## ğŸ—ï¸ ARCHITECTURE

```
supchat-1/
â”œâ”€â”€ .env                    # Configuration Docker Compose
â”œâ”€â”€ docker-compose.yml     # Orchestration des services
â”œâ”€â”€ supchat-server/        # Backend API (Node.js)
â”‚   â”œâ”€â”€ .env              # Config dÃ©veloppement backend
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ client-web/           # Frontend Web (React)
â”‚   â”œâ”€â”€ .env             # Config dÃ©veloppement web
â”‚   â””â”€â”€ Dockerfile
â”œâ”€â”€ client-mobile/       # App Mobile (React Native)
â”‚   â””â”€â”€ .env            # Config dÃ©veloppement mobile
â””â”€â”€ documentation/      # Docs techniques et utilisateur
```

## ğŸ“ CONTACT

Pour toute question technique, consulter :
- README.md de chaque service
- Documentation dans `supchat-docs/`
- Logs Docker : `docker-compose logs [service]`
